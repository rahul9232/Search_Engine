b'\nIn the 1920\'s a mad scientist by the name Exor invented a notation for evaluating complex mathematical expressions. This notation popularly goes by the name "Zenfix" notation. In more formal terms, Zenfix expression is an expression which consists of tokens. Each token is either an operation from the list { ! , ^ , / , * , + , - } or an integer.\nAll arithmetic operation here are 32-bit operations. They are defined through auxiliary unary operation 32-bit residue as follows (please read this carefully, some definitions are non-standard):\n32-bit residue of A is defined as the unique integer X in the range [-231, 231) for which the usual difference of A and X is divisible by 232.\n32-bit difference A - B is defined as a 32-bit residue of the usual difference of A and B.\n32-bit sum A + B is defined as a 32-bit residue of the usual sum of A and B.\n32-bit product A * B is defined as a 32-bit residue of the usual product of A and B.\n32-bit quotient A / B is defined as the smallest integer C in the range [-231, 231) such that B * C = A (note the B * C here is a 32-bit product of B and C). If no such integer C exists then result of division is undefined, which means that error occurs during the calculation.\n32-bit power A ^ B is defined as follows. For B > 0 we define A ^ B = A * A * ... * A, where A repeats B times (here * is a 32-bit multiplication). For B = 0 we define A ^ 0 = 1. Finally, for B < 0 we define A ^ B = 1 / (A ^ (-B)), where A ^ (-B) is defined above (-B is the usual negation of B) and / is a 32-bit division operation. If result of division here is undefined it means that error occurs during the calculation.\n32-bit factorial A! is defined as follows. For A > 0 we define A! = 1 * 2 * 3 * ... * A (here * is a 32-bit multiplication). For A = 0 we define 0! = 1. Finally, for A < 0 we define A! = (-1) * (-2) * (-3) * ... * A (here again * is a 32-bit multiplication and -X for X = 1, 2, 3, ... means usual negation).\n\nEach operation has its own priority defined by its index in this list: the smaller the index the higher the priority. Therefore,\nthe most priority operation is factorial (!),\nthe second most priority operation is exponentiation (^),\nthe third most priority operation is division (/),\nthe fourth most priority operation is multiplication (*),\nthe fifth most priority operation is addition (+),\nand, finally, the less priority operation is subtraction (-).\n\nWe could abbreviate the list of operations sorted by priority as FEDMAS (the first letter of the title of each operation was chosen).\nThe evaluation of a Zenfix expression goes as follows:\nIf expression contains a factorial sign (!) followed by an integer then we choose the leftmost such occurrence and perform the factorial operation which will be defined below. Namely, we replace the integer that follows the factorial sign by its factorial value and delete the factorial sign from the expression.\nOtherwise, if there exists an operation followed by at least 3 integers we at first choose the first operation in EDMAS with this property (that is, among operations followed by at least three integers we choose the operation with the highest priority). Then we choose the leftmost occurrence of such a case with this operation and perform calculation. Namely, we replace the operation and two following integers by the result of this operation applied to these integers. If error occurs during this calculation then you should stop evaluation of expression.\nOtherwise, if there exists an operation followed by exactly 2 integers we proceed exactly as in the previous rule.\nWe repeat the first three steps until we can no longer repeat them or error occurs during some calculation.\nAt the end of this evaluation, if we are left with a single integer, the expression is called correct, otherwise it is called incorrect. In particular, if error occurs during some calculation, the expression is incorrect.\n\nYour task is for the given Zenfix expression check whether it is correct or not by modeling process of its evaluation and output each intermediate calculation that occurs.\nInput\nThe first line of the input contains an integer T, denoting the number of test cases. The first line of each test case contains a single integer N, denoting the number of tokens in the expression. The second line contains the expression as the list of N space-separated tokens.\nConstraints\n\n1 \xe2\x89\xa4 T \xe2\x89\xa4 10000\n1 \xe2\x89\xa4 N \xe2\x89\xa4 1000\nEach token is either an integer in the range [-231, 231) or a character in the set { ! , ^ , / , * , + , - }\nThe sum of N over the input does not exceed 10000\n\nOutput\nFor each test case, output the process of evaluation of the expression. Namely, at each step when successful calculation is performed output on a separate line I O A B C. Here I is the index of the operation in the list of tokens of the current expression (tokens are number starting from 1). O is the operation itself (one of the characters in the set { ! , ^ , / , * , + , - }). A and B are the operands. In case of a factorial operation (!), output B as -1. C is the result of operation O applied to numbers A and B (or only to A in case of a factorial operation). After all possible calculations are performed output "OK" if the expression is correct, and "NOT OK" otherwise.\nExample\nInput:\n4\n5\n- 5 * 6 7\n15\n- * / 15 - 7 + 1 1 3 + 2 + 1 1\n16\n+ 2 3 4 * 1 2 3 4 ^ 6 7 * 5 6 7\n21\n! -3 + * 167 164 - 257 + 190 ! 6 - / 272 0 ^ 341 12 18 !\n\nOutput:\n3 * 6 7 42\n1 - 5 42 -37\nOK\n7 + 1 1 2\n5 - 7 2 5\n3 / 15 5 3\n2 * 3 3 9\n5 + 1 1 2\n3 + 2 2 4\n1 - 9 4 5\nOK\n5 * 1 2 2\n11 * 5 6 30\n8 ^ 6 7 279936\n1 + 2 3 5\nNOT OK\n1 ! -3 -1 -6\n10 ! 6 -1 720\n15 ^ 341 12 2062435601\nNOT OK\n\nExplanation\nExample case 1. The expression is:\n- 5 * 6 7\nConsidering evaluation rules we see that only the third rule with operation * is applicable. So we calculate * 6 7, which is 42, and replace * 6 7 with 42:\n- 5 42\nNow we are left with only one operation followed by two integers. So we calculate - 5 42, which is -37, and replace - 5 42 with -37:\n-37\nWe are left with a single integer. Therefore, expression is correct and we output "OK".\nExample case 2. The expression is:\n- * / 15 - 7 + 1 1 3 + 2 + 1 1\nThe underlined operation will be performed first as it is the only operation followed by at least three integers. So we replace + 1 1 with 2:\n- * / 15 - 7 2 3 + 2 + 1 1\nBy the same reason as above we replace - 7 2 with 5:\n- * / 15 5 3 + 2 + 1 1\nBy the same reason as above we replace / 15 5 with 3:\n- * 3 3 + 2 + 1 1\nAmong candidates * 3 3 and + 1 1, the * is performed as it has higher priority. So we replace * 3 3 with 9:\n- 9 + 2 + 1 1\nThe underlined operation is the only one followed by at least 2 integers. So we replace + 1 1 with 2:\n- 9 + 2 2\nBy the same reason as above we replace + 2 2 with 4:\n- 9 4\nNow we are left with only one operation followed by two integers. So we replace - 9 4 with 5:\n5\t\nWe are left with a single integer. Therefore, expression is correct and we output "OK".\nExample case 3. The expression is:\n+ 2 3 4 * 1 2 3 4 ^ 6 7 * 5 6 7\nAmong all the operations followed by at least 3 integers, * has the highest priority. As there are more than one such multiplications, we consider the leftmost one, which is underlined. So we replace * 1 2 with 2:\n+ 2 3 4 2 3 4 ^ 6 7 * 5 6 7\nSimilarly as above, among all the operations followed by at least 3 integers, * has the highest priority. So we replace * 5 6 with 30:\n+ 2 3 4 2 3 4 ^ 6 7 30 7\nNow, among all the operations followed by at least 3 integers, ^ has the highest priority. So we replace ^ 6 7 with 279936:\n+ 2 3 4 2 3 4 279936 30 7\nNow, there is only one operation that can be performed. So we replace + 2 3 with 5:\n5 4 2 3 4 279936 30 7\nNow, no evaluation rule can be applied and we stop the evaluation. Since we are left with more than one token, the expression is incorrect and we output "NOT OK".\n\nExample case 4. The evaluation proceeds as follows:\n! -3 + * 167 164 - 257 + 190 ! 6 - / 272 0 ^ 341 12 18 !\n-6 + * 167 164 - 257 + 190 ! 6 - / 272 0 ^ 341 12 18 !\n-6 + * 167 164 - 257 + 190 720 - / 272 0 ^ 341 12 18 !\n-6 + * 167 164 - 257 + 190 720 - / 272 0 2062435601 18 !\nNOT OK\n\nHere at first two steps the first rule (with factorials) was applied. At the 3rd and the 4th step the 3rd rule was applied. Since quotient 272 / 0 is undefined (see the definition) we stop evaluation. So the expression is incorrect and we output "NOT OK".\n\n\n\nAuthor:\nkaush_adm\n\n\nTester:\n6\xe2\x98\x85anton_lunyov\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/ZENCALC\n\n\nTags:\n\n               \n                 Euler Theorem, Extended Euclid\'s Algorithm, Modulo Multiplicative Inverse\n                 \n                     \n                     Mathematics, Number Theory, Modular Arithmetic, GCD, Euclid\'s Algorithm\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2636\n\n\nDate Added:\n21-07-2012\n\n\nTime Limit:\n1 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, BASH, JS, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n'