b'\nYou are given a tree with NN nodes (numbered 11 through NN). There are KK special nodes f1,f2,\xe2\x80\xa6,fK in this tree.\nWe define d(p,q) to be the number of edges on the unique path from node p to node q.\nYou are given a node a. For each node b from 1 to N, find the maximum value of d(a,u)\xe2\x88\x92d(b,u) where u is a special node, as well as any special node u for which that maximum value is attained.\nInput\n\nThe first line of the input contains a single integer T denoting the number of test cases. The description of T test cases follows.\nThe first line of each test case contains three space-separated integers N, K, a.\nThe second line contains K space-separated integers f1,f2,\xe2\x80\xa6,fK.\nN\xe2\x88\x921 lines follow. For each valid i, the i-th of these lines contains two space-separated integers ui and vi denoting an edge of the tree.\n\nOutput\nFor each test case, print two lines.\nIn the first line print N space-separated integers. For each valid i, the i-th integer should be the maximum value of d(a,u)\xe2\x88\x92d(i,u) where u is a special node.\nIn the second line print N space-separated integers. For each valid i, the i-th integer should be any special node u for which the maximum of d(a,u)\xe2\x88\x92d(i,u) is attained.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa4200\n1\xe2\x89\xa4K\xe2\x89\xa4N\xe2\x89\xa42\xe2\x8b\x85105\n1\xe2\x89\xa4a\xe2\x89\xa4N\n1\xe2\x89\xa4fi\xe2\x89\xa4N for each valid i\nfi\xe2\x89\xa0fj for each valid i and j such that i\xe2\x89\xa0j\n1\xe2\x89\xa4ui,vi\xe2\x89\xa4N for each valid i\nthe graph described on the input is a tree \nthe sum of N over all test cases does not exceed 4\xe2\x8b\x85105\n\nSubtasks\nSubtask #1 (10 points):\n\nT\xe2\x89\xa411\nN\xe2\x89\xa4200\nthe sum of N over all test cases does not exceed 400\n\nSubtask #2 (20 points):\n\nT\xe2\x89\xa451\nN\xe2\x89\xa42000\nthe sum of N over all test cases does not exceed 4000\n\nSubtask #3 (30 points): \n\nIt holds that ui=i, vi=i+1 for each valid i.\n\nSubtask #4 (40 points): original constraints\nSample Input\n2\n5 1 3\n2\n1 2\n1 3\n2 4\n2 5\n8 3 2\n6 5 8\n1 2\n2 3\n2 4\n2 5\n4 6\n5 7\n5 8\n\nSample Output\n1 2 0 1 1\n2 2 2 2 2\n-1 0 -1 1 1 2 0 2\n5 5 5 6 5 6 5 8\n\nExplanation\nExample case 1:  The following picture shows the tree in the first example case with special nodes in bold:\n\nThe only special node is the node 2 and a=3. Therefore, the desired maximum is d(a,2)\xe2\x88\x92d(b,2)=d(3,2)\xe2\x88\x92d(b,2)=2\xe2\x88\x92d(b,2) for each node b and it is always attained for the special node u=2.\nExample case 2: The following picture shows the tree in the second example case with special nodes bolded:\n\nThe special nodes are 6, 5 and 8, and a=2. The maximum values of d(a,u)\xe2\x88\x92d(b,u) (u being a special node) for each b are as follows:\n\nb=1: The maximum value of d(2,u)\xe2\x88\x92d(1,u) is \xe2\x88\x921 and it is achieved for u=5 since d(2,5)\xe2\x88\x92d(1,5)=1\xe2\x88\x922=\xe2\x88\x921.\nb=2: The maximum value of d(2,u)\xe2\x88\x92d(2,u) is 0 and it is achieved for u=5 since d(2,5)\xe2\x88\x92d(2,5)=1\xe2\x88\x921=0.\nb=3: The maximum value of d(2,u)\xe2\x88\x92d(3,u) is \xe2\x88\x921 and it is achieved for u=5 since d(2,5)\xe2\x88\x92d(3,5)=1\xe2\x88\x922=\xe2\x88\x921.\nb=4: The maximum value of d(2,u)\xe2\x88\x92d(4,u) is 1 and it is achieved for u=6 since d(2,6)\xe2\x88\x92d(4,6)=2\xe2\x88\x921=1.\nb=5: The maximum value of d(2,u)\xe2\x88\x92d(5,u) is 1 and it is achieved for u=5 since d(2,5)\xe2\x88\x92d(5,5)=1\xe2\x88\x920=1.\nb=6: The maximum value of d(2,u)\xe2\x88\x92d(6,u) is 2 and it is achieved for u=6 since d(2,6)\xe2\x88\x92d(6,6)=2\xe2\x88\x920=2.\nb=7: The maximum value of d(2,u)\xe2\x88\x92d(7,u) is 0 and it is achieved for u=5 since d(2,5)\xe2\x88\x92d(7,5)=1\xe2\x88\x921=0.\nb=8: The maximum value of d(2,u)\xe2\x88\x92d(8,u) is 2 and it is achieved for u=8 since d(2,8)\xe2\x88\x92d(8,8)=2\xe2\x88\x920=2.\n\n\n\n\nAuthor:\n5\xe2\x98\x85losmi247\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/SPTREE\n\n\nTags:\n\n               \n                 DFS\n                 \n                     \n                     Algorithms, Graph Algos, Traversals\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2350\n\n\nDate Added:\n2-03-2021\n\n\nTime Limit:\n1 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n'