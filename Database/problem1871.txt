b"\nYou are given a weighted directed graph of NN vertices and N2N2 edges, and an array AA of length N. Initially, every ordered pair of vertices (u,v) is connected by a directed edge u\xe2\x86\x92v of cost Au (this also includes self-loops). \nThen there were M changes in edges' weights such that the weight of the directed edge u\xe2\x86\x92v is now equal to c. You are asked to find the sum of the lengths of the shortest paths over all ordered pairs of distinct vertices.\nInput\n\nThe first line contains a single integer T denoting the number of test cases. The description of T test cases follows.\nThe first line of each test case contains a single integer N.\nThe second line contains N space-separated integers A1,A2,\xe2\x80\xa6,AN.\nThe third line of each test case contains a single integer M.\nThe next M lines contain information about the changed edges in the u v c format.\n\nOutput\nFor each test case, output the sum of the lengths of the shortest paths over all ordered pairs of vertices.\nConstraints\n\n1\xe2\x89\xa4N\xe2\x89\xa4106\n0\xe2\x89\xa4M\xe2\x89\xa42000\n0\xe2\x89\xa4Ai,c\xe2\x89\xa4106\n1\xe2\x89\xa4u,v\xe2\x89\xa4N\nThe sum of N over all tests does not exceed 106.\nThe sum of M over all tests does not exceed 2000.\nIt is guaranteed that the weight of the edge u\xe2\x86\x92v was changed at most once.\n\nSubtasks\nSubtask #1 (8 points, time limit 1 second): The sum N for all tests does not exceed 500.\nSubtask #2 (22 points, time limit 1 second): Each vertex belongs to at most one changed edge (in other words, the edges do not overlap).\nSubtask #3 (30 points, time limit 1 second): The sum M for all tests does not exceed 500.\nSubtask #4 (40 points, time limit 4.5 seconds): original constraints.\n\n                        Sample Input 1\n                        \n\n\n\n\n\n3\n3\n2 4 1\n0\n4\n1 2 3 4\n2\n1 2 1\n3 4 2\n5\n2 6 5 1 7\n5\n1 3 4\n2 4 3\n3 5 4\n4 1 2\n5 2 3\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n14\n29\n72\n\n\nExplanation\nExample case 1: The lengths of the shortest paths between vertices u and v are Au and the answer is 2\xe2\x8b\x85(2+4+1)=14.\nExample case 2: The lengths of the shortest paths between the vertices u and v are equal to Au except for the pair of vertices (3,4) for which the distance is 2.\n\n\n\nAuthor:\n6\xe2\x98\x85karpovich\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/ALLGRAPH\n\n\nTags:\n\n               \n                 Directed Graphs, Segment Trees, Lazy Propagation, Dijkstra's Algorithm\n                 \n                     \n                     Data Structures, Graphs, Advanced Data Structures, Advanced Tree Structures, Algorithms, Graph Algos, Shortest Paths\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n4031\n\n\nDate Added:\n28-04-2021\n\n\nTime Limit:\n1 - 4.5 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"