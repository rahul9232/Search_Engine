b"\nRead problems statements Hindi , Vietnamese , Mandarin Chinese , Russian and Bengali as well.\nChef has a sequence A1,A2,\xe2\x80\xa6,ANA1,A2,\xe2\x80\xa6,AN; each element of this sequence is either 00 or 11. Appy gave him a string S with length Q describing a sequence of queries. There are two types of queries:\n\n'!': right-shift the sequence A, i.e. replace A by another sequence B1,B2,\xe2\x80\xa6,BN satisfying Bi+1=Ai for each valid i and B1=AN\n'?': find the length of the longest contiguous subsequence of A with length \xe2\x89\xa4K such that each element of this subsequence is equal to 1\n\nAnswer all queries of the second type.\nInput\n\nThe first line of the input contains three space-separated integers N, Q and K.\nThe second line contains N space-separated integers A1,A2,\xe2\x80\xa6,AN.\nThe third line contains a string with length Q describing queries. Each character of this string is either '?', denoting a query of the second type, or '!', denoting a query of the first type.\n\nOutput\nFor each query of the second type, print a single line containing one integer \xe2\x80\x94 the length of the longest required subsequence.\nConstraints\n\n1\xe2\x89\xa4K\xe2\x89\xa4N\xe2\x89\xa4105\n1\xe2\x89\xa4Q\xe2\x89\xa43\xe2\x8b\x85105\n0\xe2\x89\xa4Ai\xe2\x89\xa41 for each valid i\nS contains only characters '?' and '!'\n\nSubtasks\nSubtask #1 (30 points):\n\n1\xe2\x89\xa4N\xe2\x89\xa4103\n1\xe2\x89\xa4Q\xe2\x89\xa43\xe2\x8b\x85103\n\nSubtask #2 (70 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n5 5 3\n1 1 0 1 1\n?!?!?\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n2\n3\n3\n\n\nExplanation\n\nIn the first query, there are two longest contiguous subsequences containing only 1-s: A1,A2 and A4,A5. Each has length 2.\nAfter the second query, the sequence A is [1,1,1,0,1].\nIn the third query, the longest contiguous subsequence containing only 1-s is A1,A2,A3.\nAfter the fourth query, A=[1,1,1,1,0].\nIn the fifth query, the longest contiguous subsequence containing only 1-s is A1,A2,A3,A4 with length 4. However, we only want subsequences with lengths \xe2\x89\xa4K. One of the longest such subsequences is A2,A3,A4, with length 3.\n\n\n\n\nAuthor:\n3\xe2\x98\x85hmrockstar\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/HMAPPY1\n\n\nTags:\n\n               \n                 Deque, Segment Trees, Pre processing\n                 \n                     \n                     Data Structures, Queues, Advanced Data Structures, Advanced Tree Structures, Advanced Algorithms\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n1932\n\n\nDate Added:\n25-10-2018\n\n\nTime Limit:\n1 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"