b'\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nChef opened a chain of restaurants in Chefland and invited his KK friends (numbered 11 through KK) to move there.\nChefland can be represented by a tree with N vertices (numbered 1 through N). For each valid i, the i-th vertex has a type ci. There are K+1 types of vertices: ci=0 means that there is a restaurant in vertex i, while 1\xe2\x89\xa4ci\xe2\x89\xa4K means that there is a house with a colour ci in vertex i.\nFor each valid i, the i-th friend of Chef agrees to move to Chefland only if he will live in a house of colour i. Friends want to meet frequently, so Chef needs to choose houses for his friends in such a way that for each pair of friends, there is at least one restaurant on the unique simple path between their houses.\nFind the number of ways to choose houses for all friends. Formally, you have to find the number of sequences of vertices (v1,v2,\xe2\x80\xa6,vK) such that:\n\nfor each i (1\xe2\x89\xa4i\xe2\x89\xa4K), cvi=i\nfor each i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4K), there is at least one vertex with type 0 on the path between vi and vj\n\nSince the number of these sequences could be large, compute it modulo 998,244,353.\nInput\n\nThe first line of the input contains a single integer T denoting the number of test cases. The description of T test cases follows.\nThe first line of each test case contains two space-separated integers N and K.\nThe second line contains N space-separated integers c1,c2,\xe2\x80\xa6,cN.\nEach of the next N\xe2\x88\x921 lines contains two space-separated integers u and v denoting that vertices u and v are connected by an edge.\n\nOutput\nFor each test case, print a single line containing one integer \xe2\x80\x94 the number of ways to choose houses modulo 998,244,353.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa410\n1\xe2\x89\xa4N\xe2\x89\xa4105\n2\xe2\x89\xa4K\xe2\x89\xa411\n0\xe2\x89\xa4ci\xe2\x89\xa4K for each valid i\n1\xe2\x89\xa4u,v\xe2\x89\xa4N\nthe graph described on the input is a tree\nthe sum of N over all test cases does not exceed 105\n\nSubtasks\nSubtask #1 (5 points):\n\nN\xe2\x89\xa450\nK\xe2\x89\xa43\n\nSubtask #2 (10 points):\n\nN\xe2\x89\xa42,000\nK\xe2\x89\xa42\n\nSubtask #3 (10 points): K\xe2\x89\xa42\nSubtask #4 (10 points): K\xe2\x89\xa43\nSubtask #5 (10 points):\n\nK\xe2\x89\xa47\nthe tree is linear \xe2\x80\x94 for each valid i, the i-th edge on the input connects vertices i and (i+1)\n\nSubtask #6 (40 points): K\xe2\x89\xa47\nSubtask #7 (15 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n2\n5 2\n1 2 0 1 2\n1 3\n2 3\n3 4\n3 5\n10 3\n2 1 0 1 3 2 3 2 0 3\n1 2\n3 1\n3 4\n5 4\n4 6\n3 7\n8 7\n9 10\n9 1\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n4\n7\n\n\nExplanation\nExample case 1: The 4 valid sequences are (1,2), (1,5), (4,2) and (4,5).\nExample case 2: The 7 valid sequences are:\n\n(2,6,7)\n(2,6,10)\n(2,8,5)\n(2,8,10)\n(4,1,7)\n(4,1,10)\n(4,8,10)\n\n\n\n\nAuthor:\n5\xe2\x98\x85yogesh951\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/KTTREE\n\n\nTags:\n\n               \n                 Disjoint Set Union, DP Bitmask, Bitmasking\n                 \n                     \n                     Advanced Data Structures, Advanced Algorithms, Advanced DP, Mathematics, Bit Manipulation\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\nN/A\n\n\nDate Added:\n16-12-2020\n\n\nTime Limit:\n1.5 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n'