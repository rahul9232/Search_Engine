b'\nRead problems statements Mandarin , Bengali , Hindi , Russian and Vietnamese as well.\nThere are two people walking along a tree with NN nodes (numbered 11 through NN), each of them with speed 1 edge per second.\nThe walk of the first person is described by a sequence of nodes u1,u2,\xe2\x80\xa6,uKu1,u2,\xe2\x80\xa6,uK. This person appears in node u1u1 at time 00 and walks to node u2u2 using the shortest path; then, immediately after reaching u2u2, walks to node u3u3 using the shortest path, and so on, until reaching uKuK, when this person disappears.\nThe walk of the second person is described by another sequence v1,v2,\xe2\x80\xa6,vLv1,v2,\xe2\x80\xa6,vL in the same manner.\nCount how many times these two people meet \xe2\x80\x94 in other words, how many times they reach the same node (including the first and last nodes of their walks) at the same time.\nInput\n\nThe first line of the input contains a single integer TT denoting the number of test cases. The description of TT test cases follows.\nThe first line of each test case contains three space-separated integers NN, KK and LL.\nEach of the next N\xe2\x88\x921N\xe2\x88\x921 lines contains two space-separated integers pp and qq describing an edge between node pp and node qq.\nThe following line contains KK space-separated integers u1,u2,\xe2\x80\xa6,uKu1,u2,\xe2\x80\xa6,uK.\nThe last line contains LL space-separated integers v1,v2,\xe2\x80\xa6,vLv1,v2,\xe2\x80\xa6,vL.\n\nOutput\nFor each test case, print a single line containing one integer \xe2\x80\x94 the number of times the two people meet.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa41,0001\xe2\x89\xa4T\xe2\x89\xa41,000\n2\xe2\x89\xa4N,K,L\xe2\x89\xa41052\xe2\x89\xa4N,K,L\xe2\x89\xa4105\n1\xe2\x89\xa4p,q\xe2\x89\xa4N1\xe2\x89\xa4p,q\xe2\x89\xa4N\n1\xe2\x89\xa4ui\xe2\x89\xa4N1\xe2\x89\xa4ui\xe2\x89\xa4N for each valid ii\n1\xe2\x89\xa4vi\xe2\x89\xa4N1\xe2\x89\xa4vi\xe2\x89\xa4N for each valid ii\nui\xe2\x89\xa0ui+1ui\xe2\x89\xa0ui+1 for each valid ii\nvi\xe2\x89\xa0vi+1vi\xe2\x89\xa0vi+1 for each valid ii\nthe sum of NN in all test cases does not exceed 5\xe2\x8b\x851055\xe2\x8b\x85105\nthe sum of KK in all test cases does not exceed 5\xe2\x8b\x851055\xe2\x8b\x85105\nthe sum of LL in all test cases does not exceed 5\xe2\x8b\x851055\xe2\x8b\x85105\n\nSubtasks\nSubtask #1 (30 points):\n\n2\xe2\x89\xa4N,K,L\xe2\x89\xa41032\xe2\x89\xa4N,K,L\xe2\x89\xa4103\nthe sum of NN in all test cases does not exceed 5\xe2\x8b\x851035\xe2\x8b\x85103\nthe sum of KK in all test cases does not exceed 5\xe2\x8b\x851035\xe2\x8b\x85103\nthe sum of LL in all test cases does not exceed 5\xe2\x8b\x851035\xe2\x8b\x85103\n\nSubtask #2 (70 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n1\n5 4 3\n1 2\n2 3\n2 4\n4 5\n1 4 3 5\n1 3 5\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n3\n\n\n\n\n\nAuthor:\n6\xe2\x98\x85kingofnumbers\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/TREEWLK2\n\n\nTags:\n\n               \n                 Trees, Case work, Lowest Common Ancestor, Binary lifting\n                 \n                     \n                     Data Structures, Graphs, Special, Algorithms, Graph Algos\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n3165\n\n\nDate Added:\n26-10-2018\n\n\nTime Limit:\n3 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n'