b"\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nYou are given a tree with NN vertices numbered 1 through NN as a sequence of N\xe2\x88\x921N\xe2\x88\x921 edges \xe2\x80\x94 pairs (a1,b1),(a2,b2),\xe2\x80\xa6,(aN\xe2\x88\x921,bN\xe2\x88\x921). Let's define the value of a sequence A with length N\xe2\x88\x921 as\nF(A)=N\xe2\x88\x921\xe2\x88\x91i=1Ai\xe2\x8b\x85Wi,\nwhere W1,W2,\xe2\x80\xa6,WN\xe2\x88\x921 are given weights.\nYou may change the order of the pairs and the order of elements within any pairs. Formally, consider a reordering (P,R) \xe2\x80\x94 any permutation P=(P1,P2,\xe2\x80\xa6,PN\xe2\x88\x921) of the integers 1 through N\xe2\x88\x921 and any subset R of these integers (possibly containing all of them). Let's define two sequences C=(cP1,cP2,\xe2\x80\xa6,cPN\xe2\x88\x921) and D=(dP1,dP2,\xe2\x80\xa6,dPN\xe2\x88\x921), where for each valid i, ci=ai and di=bi if i\xe2\x88\x89R, or ci=bi and di=ai if i\xe2\x88\x88R. If D is strictly increasing, the reordering is valid and its value is F(C).\nFind the maximum value of a valid reordering, i.e. the maximum F(C), and the number of valid reorderings that have this maximum value.\nInput\n\nThe first line of the input contains a single integer T denoting the number of test cases. The description of T test cases follows.\nThe first line of each test case contains a single integer N.\nThe second line contains N\xe2\x88\x921 space-separated integers W1,W2,\xe2\x80\xa6,WN\xe2\x88\x921.\nN\xe2\x88\x921 lines follow. For each i (1\xe2\x89\xa4i\xe2\x89\xa4N\xe2\x88\x921), the i-th of these lines contains two space-separated integers ai and bi.\n\nOutput\nFor each test case, print a single line containing two space-separated integers \xe2\x80\x94 the maximum value of a reordering and the number of reorderings with the maximum value.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa4100\n2\xe2\x89\xa4N\xe2\x89\xa42\xe2\x8b\x85105\n|Wi|\xe2\x89\xa4104 for each valid i\n1\xe2\x89\xa4ai,bi\xe2\x89\xa4N for each valid i\npairs (ai,bi) are edges of a tree\nthe sum of N over all test cases does not exceed 106\n\nSubtasks\nSubtask #1 (50 points):\n\nN\xe2\x89\xa41,000\nthe sum of N over all test cases does not exceed 5,000\n\nSubtask #2 (50 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n1\n4\n1 1 0\n1 2\n1 3\n3 4\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n4 2\n\n\nExplanation\nExample case 1: There are two valid orderings with value 4:\n\nP=(2,1,3), R={2,3}; C=(3,1,4) and D=(1,2,3), so F(C)=3\xe2\x8b\x851+1\xe2\x8b\x851+4\xe2\x8b\x850=4\nP=(2,1,3), R={2}; C=(3,1,3) and D=(1,2,4), so F(C)=3\xe2\x8b\x851+1\xe2\x8b\x851+3\xe2\x8b\x850=4\n\n\n\n\nAuthor:\n7\xe2\x98\x85farhod_farmon\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/BOFP\n\n\nTags:\n\n               \n                 Trees, Segment Trees, Fenwick Trees, DFS\n                 \n                     \n                     Data Structures, Graphs, Advanced Data Structures, Advanced Tree Structures, Algorithms, Graph Algos, Traversals\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2834\n\n\nDate Added:\n20-06-2019\n\n\nTime Limit:\n2 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"