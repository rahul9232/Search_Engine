b"\nRead problem statements in Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nMadoka was given a tree on her coming of age, and not a simple one, but a rooted tree of nn vertices with a root at the vertex with the number 1.\nFor all i\xe2\x89\xa52, let Pi (1\xe2\x89\xa4Pi\xe2\x89\xa4i\xe2\x88\x921) be the parent of the vertex i.\nLet's define the depth array h as follows: h1=1, and hi=hPi+1 for all i\xe2\x89\xa52.\nThe subtree of a vertex u, denoted S(u), is defined as the set of vertices v such that the unique path from 1 to v contains u. Also, we define valu=max{h(v):v\xe2\x88\x88S(u)}.\nA tree is divided into paths by a ladder decomposition if each vertex is located on exactly one path, and each vertex u with at least one child lies in the same path as its child v with the maximum valv, and if there are several such vertices, then the vertex with the minimum number is selected.\nMadoka defines the beauty of a tree in the following way. Let the ladder decomposition of the path lengths be L1,\xe2\x80\xa6,Lk, then the beauty of the tree is L21+L22+\xe2\x8b\xaf+L2k\nFor each i (1\xe2\x89\xa4i\xe2\x89\xa4n), your task is to calculate the beauty of the tree formed by the first i vertices.\nInput\n\nThe first line contains an integer T - the number of test cases. Then T test cases follow.\nThe first line of each test case contains a single integer n - the size of the tree.\nThe second line contains n\xe2\x88\x921 integers P2,\xe2\x80\xa6,Pn.\n\nOutput\nFor each test case, print in a separate line a single integer - the answer to the problem.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa410\n2\xe2\x89\xa4n\xe2\x89\xa48\xe2\x8b\x85105\n1\xe2\x89\xa4Pi<i for all 2\xe2\x89\xa4i\xe2\x89\xa4n\nThe sum of n over all test cases is at most 8\xe2\x8b\x85105\n\nSubtasks\n\nSubtask 1 (10 points): \nThe sum of n is at most 2\xe2\x8b\x85103.\nThe time limit is 1 second.\nSubtask 2 (20 points):\nhi\xe2\x89\xa43 for all i.\nThe sum of n is at most 105.\nThe time limit is 1 second.\nSubtask 3 (50 points):\nThe sum of n is at most 2\xe2\x8b\x85105.\nThe time limit is 1 second.\nSubtask 4 (20 points):\nOriginal constraints.\nThe time limit is 2.2 seconds.\n\nSample Input\n2\n6\n1 2 1 4 3\n12\n1 2 1 4 4 6 2 8 5 6 11\n\nSample Output\n0 1 4 4 5 10\n0 1 4 4 5 5 10 10 13 14 14 21\n\nExplanation\n\n\n\n\nAuthor:\n5\xe2\x98\x85fairy_winx\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/LADCOMP\n\n\nTags:\n\n               \n                 Trees, Sets, Lowest Common Ancestor, DFS, Euler Tour\n                 \n                     \n                     Data Structures, Graphs, Algorithms, Graph Algos, Traversals\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n3050\n\n\nDate Added:\n28-06-2021\n\n\nTime Limit:\n1 - 2.2 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"